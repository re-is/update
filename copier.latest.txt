Shl update - Latest version: 180403

Shl update - HTA:

<START-TEXT>
<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<meta http-equiv="X-UA-Compatible" content="IE=11">
		<meta http-equiv="MSThemeCompatible" content="Yes">
		<script type="text/javascript" src="https://rawgit.com/re-is/shl/master/library.min.js"></script>
		<script type="text/javascript">try { _SHL_ } catch(e) { alert("Nincs internet!\n\nPróbáld később."); window.close(); }</script>
		<title>ESET Licensz Másoló</title>
		<style type="text/css">

			* {
				font-family: "Calibri Light";
				font-size: 20px;
				color: #333;
			}

			#body {
				position: absolute;
				overflow: hidden;
				top: 0;
				left: 0;
				bottom: 0;
				right: 0;
				background: linear-gradient(to right, #f5f5f5, #fff);
				border: 1px solid #aaa;
			}

				#margin_page {
					position: absolute;
					top: 20px;
					left: 20px;
					bottom: 20px;
					right: 20px;
				}

					#about {
						font-style: italic;
						font-size: 18px;
					}

					#start_page {
						margin-top: 20px;
						height: auto;
					}

						#frame {
							width: 420px;
							height: 50px;
							border: none;
							visibility: hidden;
						}

						li, span {
							font-family: "Arial";
							font-size: 18px;
							letter-spacing: 0.5px;
						}

						li {
							color: #39d;
							margin-top: 20px;
						}

						span {
							color: #e63;
							font-weight: bold;
						}

						#button {
							display: inline-block;
							padding: 6px 20px 8px 20px;
							font-family: "Verdana";
							font-size: 18px;
							text-shadow: 0 0 0 transparent;
							letter-spacing: 1px;
							color: #fff;
							background-color: #999;
							transition: 0.2s;
						}

							#button:hover {
								background-color: #777;
								cursor: pointer;
							}

			#close {
				position: absolute;
				display: inline-block;
				top: -6px;
				right: 8px;
				font-size: 30px;
				padding: 3px 13px;
				z-index: 100;
			}

				#close:hover {
					background-color: #d32;
					color: #fff;
					cursor: pointer;
				}

		</style>
	</head>
	<body>
		<div id="body">
			<div id="margin_page">
				<div id="about">
					ESET 11 licensz másoló, 0403<br>
					Készítette: Reich István, 2018
				</div>
				<div id="start_page">
					<ul style="height: auto">
						<li>Zárj be minden ablakot ( böngészők, mappák, más programok )</li>
						<li>Kattints az <span>Indítás</span>-ra és <span>ne nyúlj a géphez</span>, amíg nem végez !</li>
						<li>Várd meg, hogy bezáruljon az ESET ablak.</li>
					</ul>
					Ha nem jó a kód, akkor várj 1-2 napot és próbáld újra.<br><br>
					<center><div id="button" onclick="start_autoit()">Indítás</div></center>
					<center><iframe id="frame" src="https://re-is.github.io/eset/code.html"></iframe></center>
				</div>
			</div>
		</div>
		<div id="close" onclick="window.close()">×</div>
		<script type="text/javascript">

			// Frissítés ellenőrzése:
			Shl('HTA').update({
				current_ver	: 180403,
				update_file	: "https://re-is.github.io/update/copier.latest.txt",
				msgbox_text	: "Új verzió jelent meg ezen a napon: 2018.04.03\n\nMost frissíted?"
			});

			// HTA ablak indítása:
			Shl('WND').start({
				icon		: 'eset32.ico',
				type		: 'tool',
				caption	: false,
				width		: '680px',
				height	: '320px',
				fadein	: 700
			});

			// Globális változók:
			window.g = {
				pressed : false,
				dirname : Shl('HTA').pathname('folder'),
				regpath : 'HKCR\\DesktopBackground\\Shell\\eset_license\\'
			};

			// Az ablak betöltésekor:
			Shl('WND').on_load(function() {
				// Integrálás a context menübe, ha nincs:
				try {
					Shl('WSS').RegRead(g.regpath);
				}
				catch(e) {
					Shl('WSS').RegWrite(g.regpath, 'ESET License', 'REG_SZ');
					Shl('WSS').RegWrite(g.regpath + 'Position', 'middle', 'REG_SZ');
					Shl('WSS').RegWrite(g.regpath + 'Icon', '"' + g.dirname + '\\eset24.ico"', 'REG_SZ');
					Shl('WSS').RegWrite(g.regpath + 'command\\', 'mshta.exe "' + Shl('HTA').pathname('full') + '"', 'REG_SZ');
				}
				// Gomb lenyomáskor és kattintáskor megjelenik a kód:
				document.body.onkeydown = function() { g.pressed = true }
				document.body.onkeyup = function() { g.pressed = false }
				document.body.onclick = function() {
					if (!g.pressed) return;
					Shl('#button').style.display = 'none';
					Shl('#frame').style.visibility = 'visible';
				}
			});

			// Indítás:
			function start_autoit() {
				Shl('#button').style.display = 'none';
				Shl('#frame').style.visibility = 'visible';
				Shl('WSS').Run('"' + g.dirname + '\\eset_script.exe"');
				setTimeout(function() { window.close() }, 7000);
			}

		</script>
	</body>
</html>

<END-TEXT>

